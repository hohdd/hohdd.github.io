<!DOCTYPE html><html lang="vi"><title>[User interface (UI)] giao diện người dùng (UI) cho Unity</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="[User interface (UI)] giao diện người dùng (UI) cho Unity"><meta name="author" content="Dong Ho"> <META NAME="ROBOTS" CONTENT="noindex, nofollow, noarchive, nosnippet, noimageindex"><link rel="manifest" href="/assets/manifest.json"><meta name="theme-color" content="#317EFB"/><link href="/assets/css/main.css" rel="stylesheet" media="all"><link rel="stylesheet" href="/assets/css/delay.css" media="none" onload="if(media!='all')media='all'"> <noscript><link rel="stylesheet" href="/assets/css/delay.css"></noscript><link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /><link rel="shortcut icon" type="image/png" href="/assets/img/favicon.png"><body onload="_documentReady_()"><nav class="w3-sidebar w3-black w3-animate-opacity w3-xxlarge z-index-999" style="display:none;padding-top:100px;top:0px;" id="menuElm"><div class="w3-bar-block w3-center"><h1 class="w3-bar-item w3-button w3-text-grey w3-hover-black"> <a href="/pages/about" title="About">About</a></h1><h1 class="w3-bar-item w3-button w3-text-grey w3-hover-black"> <a href="/pages/authors" title="Teams">Teams</a></h1><h1 class="w3-bar-item w3-button w3-text-grey w3-hover-black"> <a href="/pages/categories" title="Archives">Archives</a></h1><h1 class="w3-bar-item w3-button w3-text-grey w3-hover-black"> <a href="/collections" title="Collections">Collections</a></h1><h1 class="w3-bar-item w3-button w3-text-grey w3-hover-black"> <a href="/pages/tools" title="Tools">Tools</a></h1></div></nav><div class="w3-top z-index-9999 w3-white" id="navbar"><div class="w3-bar w3-padding w3-card opacity-transition-hover w3-display-container" style="letter-spacing:4px;"><div class="w3-display-left w3-padding w3-hide-small"> <img id="hat" src="/assets/img/kmw/hat63.png"> <a href="/" class="w3-bar-item">Mr.Winter</a></div><div class="w3-display-middle w3-hide-small"></div><div class="w3-right" > <span class="material-icons w3-button" id="menuIcon" onclick="toggleMenu()" title="Menu">menu</span></div></div></div><div class="w3-content w3-panel w3-animate-opacity-slow" style="max-width:1100px"><main><div class="w3-padding-32"></div><article id="articleBody"><h2>[User interface (UI)] giao diện người dùng (UI) cho Unity</h2><span class="opacity-transition-hover"> <span class="author"> <a href="/authors/dongho" class="hvr-float-shadow">Dong Ho</a> </span> <time datetime="2020-05-15T14:26:14+07:00" class="by-line">15 May 2020 <span> <a href="/collections/game-development#Chủ đề" class="hvr-float-shadow">Chủ đề</a> </span> </time> <span title="reading time">· about 32 mins read </span> </span><div class="w3-section konamiHide"><div id="search-container"> <label> <span class="dh-unnecessary">Tìm kiếm</span> <input type="text" id="search-input" placeholder="Hoặc tìm bài viết khác..." class="w3-margin-top"> </label><div id="results-container" class="w3-card"></div></div></div><div class="w3-section"><div class="content-speech"><ul class="toc-nav dh-black-8 w3-animate-opacity dh-padding-right-1em"><li class="toc-entry toc-h2"><a href="#user-interface-ui" spy-toc="User interface (UI)">User interface (UI)</a><li class="toc-entry toc-h2"><a href="#ui-toolkit" spy-toc="UI Toolkit">UI Toolkit</a><li class="toc-entry toc-h2"><a href="#sử-dụng-uxml-document-như-một-template-re-use-ở-nhiều-nơi" spy-toc="Sử dụng UXML Document như một template (re-use ở nhiều nơi)">Sử dụng UXML Document như một template (re-use ở nhiều nơi)</a><li class="toc-entry toc-h2"><a href="#tạo-một-sub-document-như-là-một-template" spy-toc="Tạo một Sub-Document như là một Template">Tạo một Sub-Document như là một Template</a><li class="toc-entry toc-h2"><a href="#edit-unpack-một-template-instance" spy-toc="Edit, Unpack một “template instance”">Edit, Unpack một “template instance”</a><li class="toc-entry toc-h2"><a href="#thêm-selector-vào-stylesheets" spy-toc="Thêm Selector vào StyleSheets">Thêm Selector vào StyleSheets</a><li class="toc-entry toc-h2"><a href="#sử-dụng-class-stylesheets-hoặc-extract-inlined-style-to-new-class-trong-mỗi-element-của-hierarchy" spy-toc="Sử dụng class StyleSheets hoặc Extract inlined Style to New Class trong mỗi Element của Hierarchy">Sử dụng class StyleSheets hoặc Extract inlined Style to New Class trong mỗi Element của Hierarchy</a><li class="toc-entry toc-h2"><a href="#sử-dụng-biến-trong-uss-với-uss-variables" spy-toc="Sử dụng biến trong USS với “USS variables”">Sử dụng biến trong USS với “USS variables”</a><li class="toc-entry toc-h2"><a href="#instantiate-uxml-from-c-scripts-and-find-visual-elements" spy-toc="Instantiate UXML from C# scripts and Find visual elements">Instantiate UXML from C# scripts and Find visual elements</a><li class="toc-entry toc-h2"><a href="#create-a-custom-control" spy-toc="Create a custom control">Create a custom control</a><li class="toc-entry toc-h2"><a href="#đóng-gói-các-tài-liệu-uxml-bằng-logic" spy-toc="Đóng gói các tài liệu UXML bằng logic">Đóng gói các tài liệu UXML bằng logic</a><ul><li class="toc-entry toc-h3"><a href="#uxml-first-approach" spy-toc="UXML-first approach">UXML-first approach</a><li class="toc-entry toc-h3"><a href="#element-first-approach" spy-toc="Element-first approach">Element-first approach</a></ul><li class="toc-entry toc-h2"><a href="#set-up-the-scene" spy-toc="Set up the scene">Set up the scene</a><li class="toc-entry toc-h2"><a href="#example-mainui-sử-dụng-thêm-uxml-cho-các-phần-khác-của-ui" spy-toc="Example: MainUI sử dụng thêm UXML cho các phần khác của UI">Example: MainUI sử dụng thêm UXML cho các phần khác của UI</a><li class="toc-entry toc-h2"><a href="#image-import-settings" spy-toc="Image import settings">Image import settings</a><li class="toc-entry toc-h2"><a href="#uss-transition-và-transition-events" spy-toc="USS transition và Transition events">USS transition và Transition events</a><li class="toc-entry toc-h2"><a href="#tips" spy-toc="Tips:">Tips:</a></ul><h2 id="user-interface-ui"> <a class="anchor" href="#user-interface-ui" aria-hidden="true" spy-title="User interface (UI)"><span class="octicon octicon-link"></span></a>User interface (UI)</h2><p>Unity cung cấp 3 hệ thống UI:<ul><li>UI Toolkit: là hệ thống UI mới nhất trong Unity. Nó được thiết kế để tối ưu hóa hiệu suất trên các nền tảng và dựa trên các công nghệ web tiêu chuẩn.<li>The Unity UI package (uGUI): là hệ thống giao diện người dùng dựa trên GameObject sử dụng Components và Game View để sắp xếp, định vị và tạo style cho giao diện người dùng.<li>IMGUI: là một hệ thống GUI điều khiển hoàn toàn bằng code.</ul><p>uGUI là giải pháp được đề xuất cho những vấn đề sau:<ul><li>Giao diện người dùng được định vị và chiếu sáng trong thế giới 3D<li>VFX với shaders tùy chỉnh và materials<li>Dễ dàng referencing từ MonoBehaviours</ul><p>UI Toolkit là giải pháp được đề xuất cho những vấn đề sau:<ul><li>Tạo ra công việc với số lượng giao diện người dùng đáng kể<li>Yêu cầu quy trình soạn thảo quen thuộc dành cho artists và designers<li>Tìm kiếm khả năng UI rendering không có kết cấu (textureless)</ul><p>IMGUI là giải pháp được đề xuất cho (Editor) những vấn đề sau:<ul><li>Quyền truy cập không hạn chế vào khả năng mở rộng của trình soạn thảo (Unity Editor)<li>Một số control chuyên dụng như TreeView<li>API nhẹ để nhanh chóng hiển thị giao diện người dùng trên màn hình</ul><h2 id="ui-toolkit"> <a class="anchor" href="#ui-toolkit" aria-hidden="true" spy-title="UI Toolkit"><span class="octicon octicon-link"></span></a>UI Toolkit</h2><p><em>Lưu ý</em>: Unity khuyên bạn nên sử dụng UI Toolkit cho các dự án phát triển UI mới của mình. Tuy nhiên, Unity UI (uGUI) và IMGUI phù hợp với một số trường hợp sử dụng nhất định và được yêu cầu để hỗ trợ các dự án không còn được dùng nữa (deprecated projects).<p><strong>UXML documents</strong>: Ngôn ngữ đánh dấu lấy cảm hứng từ HTML và XML xác định cấu trúc của giao diện người dùng và các mẫu giao diện người dùng có thể tái sử dụng. Mặc dù bạn có thể xây dựng giao diện trực tiếp trong tệp C# nhưng Unity khuyên bạn nên sử dụng tài liệu UXML nếu có thể.<p><strong>Unity Style Sheets (USS)</strong>: Các biểu định kiểu áp dụng các kiểu và hành vi trực quan cho giao diện người dùng. Chúng tương tự như Cascading Style Sheets (CSS) được sử dụng trên web và hỗ trợ một tập hợp con các thuộc tính CSS tiêu chuẩn. Mặc dù bạn có thể áp dụng kiểu trực tiếp trong tệp C# nhưng Unity khuyên bạn nên sử dụng tệp USS nếu có thể.<p>Sử dụng các công cụ sau để tạo và gỡ lỗi giao diện của bạn cũng như tìm hiểu cách sử dụng UI Toolkit:<ul><li> <strong>UI Debugger</strong>: Một công cụ chẩn đoán tương tự như chế độ xem gỡ lỗi của trình duyệt web. Sử dụng nó để khám phá hệ thống phân cấp các phần tử và nhận thông tin về cấu trúc UXML cơ bản của nó và các kiểu USS. Bạn có thể tìm thấy nó trong Trình chỉnh sửa trong “<strong>Window &gt; UI Toolkit &gt; Debugger</strong>”.<li> <strong>UI Builder</strong>: cho phép bạn tạo và chỉnh sửa trực quan các nội dung của Bộ công cụ giao diện người dùng như tệp UXML và USS.<li> <strong>UI Samples</strong>: Thư viện mẫu mã. <strong>Window &gt; UI Toolkit &gt; Samples.</strong>.</ul><p>Bạn có thể thêm các UI Controls theo những cách sau:<ul><li>Sử dụng UI Builder để thêm các UI Controls một cách trực quan<li>Sử dụng tệp văn bản giống XML (UXML) để thêm các UI Controls<li>Sử dụng tập lệnh C# để thêm các UI Controls</ul><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">MyCustomEditor</span> <span class="p">:</span> <span class="n">EditorWindow</span> <span class="c1">// custom Editor</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span>
    <span class="k">private</span> <span class="n">VisualTreeAsset</span> <span class="n">m_UXMLTree</span><span class="p">;</span> <span class="c1">// là private nhưng thêm [SerializeField] để kéo thả file UXML vào làm reference</span>

    <span class="k">private</span> <span class="kt">int</span> <span class="n">m_ClickCount</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">// lưu và tăng dần mỗi lần button được click</span>

    <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">m_ButtonPrefix</span> <span class="p">=</span> <span class="s">"button"</span><span class="p">;</span> <span class="c1">// sử dụng để tìm Toggle theo Name, quy tắc đặt tên Button và Toggle cần giống nhau theo cách này</span>

    <span class="p">[</span><span class="nf">MenuItem</span><span class="p">(</span><span class="s">"Window/UI Toolkit/MyCustomEditor"</span><span class="p">)]</span> <span class="c1">// vị trí để có thể open 'MyCustomEditor' trong 'Editor'</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ShowExample</span><span class="p">()</span> <span class="c1">// khi click vào menu thì sẽ call hàm này</span>
    <span class="p">{</span>
        <span class="n">MyCustomEditor</span> <span class="n">wnd</span> <span class="p">=</span> <span class="n">GetWindow</span><span class="p">&lt;</span><span class="n">MyCustomEditor</span><span class="p">&gt;();</span> <span class="c1">// trả về một 'EditorWindow' với kiểu là 'MyCustomEditor' là Window này</span>
        <span class="n">wnd</span><span class="p">.</span><span class="n">titleContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GUIContent</span><span class="p">(</span><span class="s">"CustomEditor của tôi"</span><span class="p">);</span> <span class="c1">// set title cho nó</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">CreateGUI</span><span class="p">()</span> <span class="c1">// hàm này được call khi init Window</span>
    <span class="p">{</span>
        <span class="c1">// Each editor window contains a root VisualElement object</span>
        <span class="n">VisualElement</span> <span class="n">root</span> <span class="p">=</span> <span class="n">rootVisualElement</span><span class="p">;</span> <span class="c1">// tương đương với 'document' của HTML</span>

        <span class="c1">// Các đối tượng VisualElements có thể chứa các VisualElement khác theo hệ thống phân cấp cây.</span>
        <span class="n">VisualElement</span> <span class="n">label</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Label</span><span class="p">(</span><span class="s">"These controls were created using C# code."</span><span class="p">);</span> <span class="c1">// mỗi Control hoặc 1 nhóm Controls được add vào 1 VisualElement, VisualElement đó được add vào root (document) để hiển thị</span>
        <span class="n">root</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">label</span><span class="p">);</span> <span class="c1">// Control muốn hiển thị thì phải add vào root (document)</span>

        <span class="n">Button</span> <span class="n">button</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Button</span><span class="p">();</span>
        <span class="n">button</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">"button3"</span><span class="p">;</span>
        <span class="n">button</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="s">"This is button3."</span><span class="p">;</span>
        <span class="n">root</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">button</span><span class="p">);</span> <span class="c1">// Control muốn hiển thị thì phải add vào root (document)</span>

        <span class="n">Toggle</span> <span class="n">toggle</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Toggle</span><span class="p">();</span>
        <span class="n">toggle</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">"toggle3"</span><span class="p">;</span> <span class="c1">// quy tắc đặt tên cần giống button để lấy number ở bên dưới</span>
        <span class="n">toggle</span><span class="p">.</span><span class="n">label</span> <span class="p">=</span> <span class="s">"Number?"</span><span class="p">;</span>
        <span class="n">root</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">toggle</span><span class="p">);</span> <span class="c1">// Control muốn hiển thị thì phải add vào root (document)</span>

        <span class="c1">// Import UXML sử dụng 'AssetDatabase' (Editor only, Runtime sử dụng "Addressables" hoặc Drag reference trong Inspector thông qua một Script:MonoBehaviour)</span>
        <span class="c1">// nếu UXML và USS đặt trong thư mục "Resources" thì có thể sử dụng "Resources.Load". VD: VisualTreeAsset uxml = Resources.Load&lt;VisualTreeAsset&gt;("main_window");</span>
        <span class="kt">var</span> <span class="n">visualTree</span> <span class="p">=</span> <span class="n">AssetDatabase</span><span class="p">.</span><span class="n">LoadAssetAtPath</span><span class="p">&lt;</span><span class="n">VisualTreeAsset</span><span class="p">&gt;(</span><span class="s">"Assets/Editor/MyCustomEditor.uxml"</span><span class="p">);</span> <span class="c1">// UXML là thể hiện của 'VisualTreeAsset'</span>
        <span class="n">VisualElement</span> <span class="n">labelFromUXML</span> <span class="p">=</span> <span class="n">visualTree</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">();</span> <span class="c1">// tạo 'VisualElement' từ 'VisualTreeAsset' là một nhóm Controls để 'Visual'</span>
        <span class="n">root</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">labelFromUXML</span><span class="p">);</span> <span class="c1">// add vào root (document)</span>

        <span class="n">root</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">m_UXMLTree</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">());</span> <span class="c1">// cách viết rút gọn: từ Reference UXML -&gt; tạo 'VisualElement' (Instantiate) -&gt; add vào root</span>

        <span class="c1">//Call the event handler</span>
        <span class="nf">SetupButtonHandler</span><span class="p">();</span> <span class="c1">// gọi thủ tục (hàm) để thêm Handler cho các buttons</span>
    <span class="p">}</span>

    <span class="c1">// thêm Handler cho các buttons</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">SetupButtonHandler</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">VisualElement</span> <span class="n">root</span> <span class="p">=</span> <span class="n">rootVisualElement</span><span class="p">;</span> <span class="c1">// 'rootVisualElement' giống 'gameObject', luôn trỏ đến gốc root (document)</span>

        <span class="kt">var</span> <span class="n">buttons</span> <span class="p">=</span> <span class="n">root</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;();</span> <span class="c1">// 'Query' hoặc 'Q', tìm theo tên hoặc tất cả nếu ko nhập tên.</span>
        <span class="n">buttons</span><span class="p">.</span><span class="nf">ForEach</span><span class="p">(</span><span class="n">RegisterHandler</span><span class="p">);</span> <span class="c1">// duyệt tất cả buttons và Handler cho mỗi button</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">RegisterHandler</span><span class="p">(</span><span class="n">Button</span> <span class="n">button</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">button</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">ClickEvent</span><span class="p">&gt;(</span><span class="n">PrintClickMessage</span><span class="p">);</span> <span class="c1">// đăng ký Callback khi button được bấm, Callback nhận đối số 'ClickEvent' chứa các thông tin liên quan đến event đó</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">PrintClickMessage</span><span class="p">(</span><span class="n">ClickEvent</span> <span class="n">evt</span><span class="p">)</span> <span class="c1">// Callback được gọi khi button được bấm</span>
    <span class="p">{</span>
        <span class="n">VisualElement</span> <span class="n">root</span> <span class="p">=</span> <span class="n">rootVisualElement</span><span class="p">;</span> <span class="c1">// lấy root reference</span>

        <span class="p">++</span><span class="n">m_ClickCount</span><span class="p">;</span> <span class="c1">// tăng bộ đếm</span>

        <span class="n">Button</span> <span class="n">button</span> <span class="p">=</span> <span class="n">evt</span><span class="p">.</span><span class="n">currentTarget</span> <span class="k">as</span> <span class="n">Button</span><span class="p">;</span> <span class="c1">// IEventHandler currentTarget</span>
        <span class="kt">string</span> <span class="n">buttonNumber</span> <span class="p">=</span> <span class="n">button</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="n">m_ButtonPrefix</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span> <span class="c1">// Substring để lấy con số tương ứng vì Button và Toggle đặt tên giống nhau</span>
        <span class="kt">string</span> <span class="n">toggleName</span> <span class="p">=</span> <span class="s">"toggle"</span> <span class="p">+</span> <span class="n">buttonNumber</span><span class="p">;</span> <span class="c1">// tạo tên Toggle tương ứng với Button</span>
        <span class="n">Toggle</span> <span class="n">toggle</span> <span class="p">=</span> <span class="n">root</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">Toggle</span><span class="p">&gt;(</span><span class="n">toggleName</span><span class="p">);</span> <span class="c1">// truy vấn Toggle theo tên, vì trả về chỉ có 1 Object nên Name của Element phải là DUY NHẤT (không thì sẽ trả về phần tử đầu tiên ???)</span>

        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Button was clicked!"</span> <span class="p">+</span> <span class="p">(</span><span class="n">toggle</span><span class="p">.</span><span class="k">value</span> <span class="p">?</span> <span class="s">" Count: "</span> <span class="p">+</span> <span class="n">m_ClickCount</span> <span class="p">:</span> <span class="s">""</span><span class="p">));</span> <span class="c1">// in ra console Log</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="sử-dụng-uxml-document-như-một-template-re-use-ở-nhiều-nơi"> <a class="anchor" href="#s%E1%BB%AD-d%E1%BB%A5ng-uxml-document-nh%C6%B0-m%E1%BB%99t-template-re-use-%E1%BB%9F-nhi%E1%BB%81u-n%C6%A1i" aria-hidden="true" spy-title="Sử dụng UXML Document như một template (re-use ở nhiều nơi)"><span class="octicon octicon-link"></span></a>Sử dụng UXML Document như một template (re-use ở nhiều nơi)</h2><p>Trong UI Builder, kéo file .UXML (Library &gt; Project tab) vào Hierarchy. “Template Instance” xuất hiện trong Hierarchy như một element bình thường và có kiểu là “<strong>TemplateContainer</strong>”. các properties của ‘internal hierarchy’ này chỉ đọc và chỉ để tham khảo.<p>Trong UXML sử dụng template sẽ có khai báo giống thế này:<ul><li><code class="highlighter-rouge">&lt;ui:Template name="ListEntry" src="project://database/Assets/UI/ListEntry.uxml?fileID=9197481963319205126&amp;amp;guid=f511ca1ef59a15b4aa606c94f8049527&amp;amp;type=3#ListEntry" /&gt;</code><li><code class="highlighter-rouge">&lt;ui:Instance template="ListEntry" name="ListEntry" /&gt;</code></ul><h2 id="tạo-một-sub-document-như-là-một-template"> <a class="anchor" href="#t%E1%BA%A1o-m%E1%BB%99t-sub-document-nh%C6%B0-l%C3%A0-m%E1%BB%99t-template" aria-hidden="true" spy-title="Tạo một Sub-Document như là một Template"><span class="octicon octicon-link"></span></a>Tạo một Sub-Document như là một Template</h2><p>Trong UI Builder, click chuột phải vào c (một phần UXML hiện tại trong Hierarchy) và chọn “Create Template” &gt; sau khi tạo Template thì Sub-Document trở thành “<strong>TemplateContainer</strong>”.<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ui:Template</span> <span class="na">name=</span><span class="s">"ListEntry"</span> <span class="na">src=</span><span class="s">"project://database/Assets/UI/ListEntry.uxml?fileID=9197481963319205126&amp;amp;guid=f511ca1ef59a15b4aa606c94f8049527&amp;amp;type=3#ListEntry"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:Template</span> <span class="na">name=</span><span class="s">"background"</span> <span class="na">src=</span><span class="s">"project://database/Assets/UI/Templates/background.uxml?fileID=9197481963319205126&amp;amp;guid=4081ee76a069a0c41a0b2ae2be816d44&amp;amp;type=3#background"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Style</span> <span class="na">src=</span><span class="s">"project://database/Assets/UI/MainView.uss?fileID=7433441132597879392&amp;amp;guid=4d46447ce418de347874c3011cf5d723&amp;amp;type=3#MainView"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:Instance</span> <span class="na">template=</span><span class="s">"background"</span> <span class="na">name=</span><span class="s">"background"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:Instance</span> <span class="na">template=</span><span class="s">"ListEntry"</span> <span class="na">name=</span><span class="s">"ListEntry"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><h2 id="edit-unpack-một-template-instance"> <a class="anchor" href="#edit-unpack-m%E1%BB%99t-template-instance" aria-hidden="true" spy-title="Edit, Unpack một “template instance”"><span class="octicon octicon-link"></span></a>Edit, Unpack một “template instance”</h2><ul><li> <strong>Open in UI Builder</strong>: Unload Tài liệu UXML hiện tại và Load Template Instance trong UI Builder:<li> <strong>Open Instance in Isolation</strong>: Giữ Tài liệu UXML hiện tại được tải ở chế độ nền trong khi tải Template Instance. Hệ thống phân cấp và Canvas chỉ hiển thị nội dung của Template Instance và khung StyleSheets bao gồm biểu định kiểu của Tài liệu UXML gốc ở trạng thái chỉ đọc. Điều này là do các biểu định kiểu vẫn đang được áp dụng cho Template Instance:<li> <strong>Open Instance in Context</strong>: Giữ Tài liệu UXML hiện tại được tải trong khi đặt tất cả các thành phần của nó ở chế độ chỉ đọc và xuất hiện mờ trong Hệ thống phân cấp và Canvas. Bạn có thể chỉnh sửa nội dung của Phiên bản mẫu trong ngữ cảnh của Tài liệu UXML gốc. Sử dụng tùy chọn này để cập nhật nội dung Phiên bản mẫu mà không làm mất ngữ cảnh của UXML hiện tại.<li> <strong>Unpack Instance</strong>: nhấp chuột phải vào Phiên bản mẫu và chọn Giải nén phiên bản.<li> <strong>Unpack Instance Completely</strong>: Điều này thay đổi tất cả các Phiên bản mẫu thành Tài liệu UXML thông thường.</ul><h2 id="thêm-selector-vào-stylesheets"> <a class="anchor" href="#th%C3%AAm-selector-v%C3%A0o-stylesheets" aria-hidden="true" spy-title="Thêm Selector vào StyleSheets"><span class="octicon octicon-link"></span></a>Thêm Selector vào StyleSheets</h2><div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">#elementNameOrId</span> <span class="o">(</span><span class="nt">bắt</span> <span class="nt">đầu</span> <span class="nt">với</span> <span class="err">#</span><span class="o">)</span>
<span class="nc">.styleClassName</span> <span class="o">(</span><span class="nt">bắt</span> <span class="nt">đầu</span> <span class="nt">với</span> <span class="o">.)</span>
<span class="nc">.parentClassName</span> <span class="o">&gt;</span> <span class="nc">.directChildClassName</span>
<span class="nc">.parentClassName</span> <span class="nc">.childClassName</span> <span class="o">(</span><span class="nt">ở</span> <span class="nt">bất</span> <span class="nt">cứ</span> <span class="nt">depth</span> <span class="nt">nào</span><span class="o">)</span>
<span class="nc">.styleClassName</span><span class="nd">:hover</span> <span class="o">(</span><span class="nt">pseudo-classes</span><span class="o">)</span>
<span class="nc">.styleClassName</span><span class="nd">:focus</span> <span class="o">(</span><span class="nt">pseudo-classes</span><span class="o">:</span> <span class="nt">active</span><span class="o">,</span> <span class="nt">inactive</span><span class="o">,</span> <span class="nt">selected</span><span class="o">,</span> <span class="nt">disabled</span><span class="o">...)</span>
</code></pre></div></div><h2 id="sử-dụng-class-stylesheets-hoặc-extract-inlined-style-to-new-class-trong-mỗi-element-của-hierarchy"> <a class="anchor" href="#s%E1%BB%AD-d%E1%BB%A5ng-class-stylesheets-ho%E1%BA%B7c-extract-inlined-style-to-new-class-trong-m%E1%BB%97i-element-c%E1%BB%A7a-hierarchy" aria-hidden="true" spy-title="Sử dụng class StyleSheets hoặc Extract inlined Style to New Class trong mỗi Element của Hierarchy"><span class="octicon octicon-link"></span></a>Sử dụng class StyleSheets hoặc Extract inlined Style to New Class trong mỗi Element của Hierarchy</h2><p>Click vào Element trong Hierarchy &gt; trong Inspector tới phần “Style Class List”. Thao tác này sẽ thêm className vào trong Element (giống HTML CSS: class=”w3-btn w3-padding”). Hoặc kéo ClassName từ StyleSheets xuống Element trong Hierarchy.<h2 id="sử-dụng-biến-trong-uss-với-uss-variables"> <a class="anchor" href="#s%E1%BB%AD-d%E1%BB%A5ng-bi%E1%BA%BFn-trong-uss-v%E1%BB%9Bi-uss-variables" aria-hidden="true" spy-title="Sử dụng biến trong USS với “USS variables”"><span class="octicon octicon-link"></span></a>Sử dụng biến trong USS với “USS variables”</h2><p>Trong UI Builder không thể tạo USS variables, sử dụng text editor để thêm:<ul><li>Để tạo một biến USS, hãy đặt trước tên của nó một dấu gạch ngang kép (–). VD: <code class="highlighter-rouge">--color-1: red;</code><li>Để sử dụng giá trị biến USS trong quy tắc USS khác, hãy sử dụng hàm var() để gọi nó. VD: <code class="highlighter-rouge">var(--color-1);</code><li>Khi bạn cập nhật một biến, nó sẽ cập nhật tất cả các thuộc tính USS sử dụng biến đó. (tất nhiên)<li>Chỉ định giá trị mặc định (Fallback) cho các biến USS nếu không tìm thấy giá trị của biến. VD: <code class="highlighter-rouge">var(--color-1, #FF0000);</code><li>USS không hỗ trợ các phép toán trên biến VÀ không hỗ trợ hàm var() bên trong các hàm khác. VD: <code class="highlighter-rouge">background-color: rgb(var(--red), 0, 0);</code><li>Trong UI Builder có thể xem được property nào đang sử dụng giá trị biến thì label sẽ được bọc trong 1 box<br><img src="https://docs.unity3d.com/2021.3/Documentation/uploads/Main/UIBuilder/USSVariablesSet.png" alt="TEXT" class="w3-image cursor-zoom" onclick="onZoomImg(this)"></ul><div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">:root</span> <span class="p">{</span>
  <span class="py">--color-1</span><span class="p">:</span> <span class="no">blue</span><span class="p">;</span>
  <span class="py">--color-2</span><span class="p">:</span> <span class="no">yellow</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.paragraph-regular</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="n">--color-1</span><span class="p">);</span>
  <span class="nl">background</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="n">--color-2</span><span class="p">);</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">2px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.paragraph-reverse</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="n">--color-2</span><span class="p">);</span>
  <span class="nl">background</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="n">--color-1</span><span class="p">);</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">2px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="instantiate-uxml-from-c-scripts-and-find-visual-elements"> <a class="anchor" href="#instantiate-uxml-from-c-scripts-and-find-visual-elements" aria-hidden="true" spy-title="Instantiate UXML from C# scripts and Find visual elements"><span class="octicon octicon-link"></span></a>Instantiate UXML from C# scripts and Find visual elements</h2><p><strong>Instantiate</strong>:<ul><li>Trước tiên bạn phải tải tệp vào <strong>VisualTreeAsset</strong>, sau đó sử dụng <strong>Instantiate()</strong> để khởi tạo.<li>Sau khi UXML được khởi tạo, bạn có thể truy xuất các phần tử cụ thể từ cây trực quan với UQuery (Query / Q)</ul><p><strong>UQuery</strong> được lấy cảm hứng từ JQuery và Linq và được thiết kế để hạn chế việc phân bổ bộ nhớ động. Điều này cho phép hiệu suất tối ưu trên nền tảng di động.<ul><li>Để sử dụng UQuery để tìm các phần tử, trước tiên bạn phải tải và khởi tạo UXML, sau đó sử dụng <strong>Query</strong> hoặc <strong>Q</strong> để xây dựng các quy tắc selection trên phần tử trực quan gốc.<li>Bạn có thể truy vấn các phần tử theo tên, lớp USS hoặc loại phần tử của chúng (Button, Label, VisualElement…). Bạn cũng có thể truy vấn bằng một vị từ hoặc thực hiện các truy vấn phân cấp phức tạp.</ul><p><strong>Query elements</strong>:<ul><li>Query(name: “element-name”): có thể bỏ qua ‘name’ vì nó là first argument. VD: <code class="highlighter-rouge">List&lt;VisualElement&gt; result = root.Query("OK").ToList();</code><li>Một số hàm UQueryBuilder có thể sử dụng: .ToList() .First() .AtIndex(1) .Last()<li>Query(className: “class-name”): Ví dụ tìm tất cả các element có class “yellow” và gán chúng vào một List: <code class="highlighter-rouge">List&lt;VisualElement&gt; result = root.Query(className: "yellow").ToList();</code><li><code class="highlighter-rouge">Query&lt;Type&gt;: VD: VisualElement result = root.Query&lt;Button&gt;().AtIndex(2);</code><li>Query with a predicate: VD: <code class="highlighter-rouge">List&lt;VisualElement&gt; result = root.Query(className: "yellow").Where(elem =&gt; elem.tooltip == "").ToList();</code><li>Complex hierarchical queries:<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">VisualElement</span> <span class="n">result</span> <span class="p">=</span> <span class="n">root</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="n">className</span><span class="p">:</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s">"OK"</span><span class="p">).</span><span class="nf">First</span><span class="p">();</span>
<span class="n">VisualElement</span> <span class="n">result</span> <span class="p">=</span> <span class="n">root</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">VisualElement</span><span class="p">&gt;(</span><span class="s">"container2"</span><span class="p">).</span><span class="n">Children</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="s">"Cancel"</span><span class="p">).</span><span class="nf">First</span><span class="p">();</span>
<span class="n">root</span><span class="p">.</span><span class="nf">Query</span><span class="p">().</span><span class="nf">Where</span><span class="p">(</span><span class="n">elem</span> <span class="p">=&gt;</span> <span class="n">elem</span><span class="p">.</span><span class="n">tooltip</span> <span class="p">==</span> <span class="s">""</span><span class="p">).</span><span class="nf">ForEach</span><span class="p">(</span><span class="n">elem</span> <span class="p">=&gt;</span> <span class="n">elem</span><span class="p">.</span><span class="n">tooltip</span><span class="p">=</span><span class="s">"This is a tooltip!"</span><span class="p">);</span>
</code></pre></div></div><li>Hãy cân nhắc những điều sau khi bạn sử dụng UQuery:<ul><li>UQuery duyệt qua hệ thống phân cấp để tìm các phần tử theo tên, lớp hoặc loại. Kết quả bộ đệm từ UQuery khi khởi tạo.<li>Nếu bạn cần truy xuất nhiều phần tử, hãy sử dụng cấu trúc QueryState (được trả về bởi phương thức element.Query()) và liệt kê nó để tránh tạo danh sách. Bạn cũng có thể tạo một truy vấn một lần và thực hiện nó trên các phần tử khác nhau.<li>UI Toolkit <strong>không destroy</strong> các visual elements không còn cần thiết, nó sử dụng trình thu gom rác C# để thu thập chúng. Hãy lưu ý để <strong>không vô tình giữ lại các tham chiếu</strong> đến các visual elements trong một lớp tồn tại lâu hơn UIDocuments hoặc Window nơi chứa các phần tử đó.<li>Ghi lại (Capture) các biến VisualElement bên trong các closures.<li>Khi bạn tạo hoặc phát hành nhiều phần tử, hãy bật tính năng thu thập rác tăng dần (incremental garbage collection) trong <strong>Project Settings</strong> để tránh mức tăng đột biến của trình thu gom rác.</ul></ul><h2 id="create-a-custom-control"> <a class="anchor" href="#create-a-custom-control" aria-hidden="true" spy-title="Create a custom control"><span class="octicon octicon-link"></span></a>Create a custom control</h2><p>Tạo Class extend “<strong>VisualElement</strong>” (ko extend built-in UI controls vì nó có thể thay đổi trong tương lai).<p>Bạn có thể khởi tạo một điều khiển tùy chỉnh trong constructor của nó. Tuy nhiên, nếu ứng dụng của bạn cần, bạn có thể trì hoãn việc khởi chạy cho đến khi điều khiển tùy chỉnh được thêm vào giao diện người dùng. Để thực hiện việc này, hãy đăng ký lệnh gọi lại cho <strong>AttachToPanelEvent</strong>. Để phát hiện điều khiển tùy chỉnh của bạn đã bị xóa khỏi giao diện người dùng, hãy sử dụng lệnh gọi lại <strong>DetachFromPanelEvent</strong>.<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">myCustomElement</span> <span class="p">=</span> <span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="n">className</span><span class="p">:</span> <span class="s">"my-custom-element"</span><span class="p">);</span>
<span class="n">myCustomElement</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">AttachToPanelEvent</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span>
    <span class="p">{</span> <span class="cm">/* do something here when element is added to UI */</span> <span class="p">});</span>
<span class="n">myCustomElement</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">DetachFromPanelEvent</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span>
    <span class="p">{</span> <span class="cm">/* do something here when element is removed from UI */</span> <span class="p">});</span>
</code></pre></div></div><p>Tham khảo thêm <a href="https://docs.unity3d.com/2021.3/Documentation/Manual/UIE-create-custom-controls.html" class="hvr-forward" rel="nofollow" target="_blank">Create a custom control</a><h2 id="đóng-gói-các-tài-liệu-uxml-bằng-logic"> <a class="anchor" href="#%C4%91%C3%B3ng-g%C3%B3i-c%C3%A1c-t%C3%A0i-li%E1%BB%87u-uxml-b%E1%BA%B1ng-logic" aria-hidden="true" spy-title="Đóng gói các tài liệu UXML bằng logic"><span class="octicon octicon-link"></span></a>Đóng gói các tài liệu UXML bằng logic</h2><p><img src="https://docs.unity3d.com/2021.3/Documentation/uploads/Main/uxml/reusable-card.png" alt="TEXT" class="w3-image cursor-zoom" onclick="onZoomImg(this)"><p>Tách giao diện người dùng khỏi mã trò chơi hoặc ứng dụng của bạn:<ul><li>Sử dụng UXML để xác định cấu trúc<li>Sử dụng USS để xác định giao diện<li>Sử dụng C# để xác định logic của điều khiển.</ul><h3 id="uxml-first-approach"> <a class="anchor" href="#uxml-first-approach" aria-hidden="true" spy-title="UXML-first approach"><span class="octicon octicon-link"></span></a>UXML-first approach</h3><p>Cách tiếp cận UXML-first sẽ thêm children sau khi xây dựng element.<ol><li><p>Tạo UXML document (CardElement.uxml)<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;Style</span> <span class="na">src=</span><span class="s">"CardElementUI.uss"</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;CardElement&gt;</span> 
         <span class="nt">&lt;ui:VisualElement</span> <span class="na">name=</span><span class="s">"image"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;ui:VisualElement</span> <span class="na">name=</span><span class="s">"stats"</span><span class="nt">&gt;</span>
             <span class="nt">&lt;ui:Label</span> <span class="na">name=</span><span class="s">"attack-badge"</span> <span class="na">class=</span><span class="s">"badge"</span> <span class="nt">/&gt;</span>
             <span class="nt">&lt;ui:Label</span> <span class="na">name=</span><span class="s">"health-badge"</span> <span class="na">class=</span><span class="s">"badge"</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;/ui:VisualElement&gt;</span>
     <span class="nt">&lt;/CardElement&gt;</span> 
 <span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><li><p>Tạo “custom control class” (CardElement.cs): Lớp điều khiển tùy chỉnh gán giá trị hình ảnh và huy hiệu cho CardElement ở một hàm Init() riêng.<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
 <span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

 <span class="c1">// Define the custom control type.</span>
 <span class="k">public</span> <span class="k">class</span> <span class="nc">CardElement</span> <span class="p">:</span> <span class="n">VisualElement</span>
 <span class="p">{</span>
     <span class="c1">// EXPOSE the custom control to UXML and UI Builder.</span>
     <span class="k">public</span> <span class="k">new</span> <span class="k">class</span> <span class="nc">UxmlFactory</span> <span class="p">:</span> <span class="n">UxmlFactory</span><span class="p">&lt;</span><span class="n">CardElement</span><span class="p">&gt;</span> <span class="p">{}</span>

     <span class="k">private</span> <span class="n">VisualElement</span> <span class="n">portraitImage</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="s">"image"</span><span class="p">);</span>
     <span class="k">private</span> <span class="n">Label</span> <span class="n">attackBadge</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">Label</span><span class="p">&gt;(</span><span class="s">"attack-badge"</span><span class="p">);</span>
     <span class="k">private</span> <span class="n">Label</span> <span class="n">healthBadge</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">Label</span><span class="p">&gt;(</span><span class="s">"health-badge"</span><span class="p">);</span>

     <span class="c1">// Use the Init() approach instead of a constructor because we don't have children yet.</span>
     <span class="k">public</span> <span class="k">void</span> <span class="nf">Init</span><span class="p">(</span><span class="n">Texture2D</span> <span class="n">image</span><span class="p">,</span> <span class="kt">int</span> <span class="n">health</span><span class="p">,</span> <span class="kt">int</span> <span class="n">attack</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">portraitImage</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">backgroundImage</span> <span class="p">=</span> <span class="n">image</span><span class="p">;</span>
         <span class="n">attackBadge</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">health</span><span class="p">;</span>
         <span class="n">healthBadge</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">attack</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="c1">// Custom controls need a DEFAULT constructor. </span>
     <span class="k">public</span> <span class="nf">CardElement</span><span class="p">()</span> <span class="p">{}</span>
 <span class="p">}</span>
</code></pre></div></div><li><p>Khởi tạo trực tiếp trong C#<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
 <span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

 <span class="k">public</span> <span class="k">class</span> <span class="nc">UIManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="c1">// Script này sẽ được đính kèm vào </span>
 <span class="p">{</span>
     <span class="k">public</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span> <span class="c1">// hoặc OnEnable(): được call khi object được enable hoặc active</span>
     <span class="p">{</span>
         <span class="n">UIDocument</span> <span class="n">document</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">UIDocument</span><span class="p">&gt;();</span>

         <span class="c1">// Load the UXML document (template) that defines CardElement.</span>
         <span class="c1">// It assumes the UXML file (CardElement.uxml) is placed at the "Resources" folder.</span>
         <span class="n">VisualTreeAsset</span> <span class="n">template</span> <span class="p">=</span> <span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">&lt;</span><span class="n">VisualTreeAsset</span><span class="p">&gt;(</span><span class="s">"CardElement"</span><span class="p">);</span> <span class="c1">// (CardElement.uxml)</span>

         <span class="c1">// Create a loop to modify properties and perform interactions for each card.</span>
         <span class="c1">// It assumes that you have created a function called `GetCards()` to get all the cards in your game.</span>
         <span class="k">foreach</span><span class="p">(</span><span class="n">Card</span> <span class="n">card</span> <span class="k">in</span> <span class="nf">GetCards</span><span class="p">())</span> <span class="c1">// CardData : ScriptableObject với [CreateAssetMenu] ...</span>
         <span class="p">{</span>
             <span class="c1">// Instantiate a template container.</span>
             <span class="kt">var</span> <span class="n">templateContainer</span> <span class="p">=</span> <span class="n">template</span><span class="p">.</span><span class="nf">Instantiate</span><span class="p">();</span>

             <span class="c1">// Find the custom element inside the template container.</span>
             <span class="kt">var</span> <span class="n">cardElement</span> <span class="p">=</span> <span class="n">templateContainer</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">CardElement</span><span class="p">&gt;();</span>

             <span class="c1">// Add the custom element into the scene.</span>
             <span class="n">document</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">cardElement</span><span class="p">);</span>

             <span class="c1">// Initialize the card.</span>
             <span class="n">cardElement</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="n">card</span><span class="p">.</span><span class="n">image</span><span class="p">,</span> <span class="n">card</span><span class="p">.</span><span class="n">health</span><span class="p">,</span> <span class="n">card</span><span class="p">.</span><span class="n">attack</span><span class="p">);</span>

             <span class="c1">// Register an event callback for additional interaction.</span>
             <span class="n">cardElement</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">ClickEvent</span><span class="p">&gt;(</span><span class="n">SomeInteraction</span><span class="p">);</span>
         <span class="p">}</span>
     <span class="p">}</span>

     <span class="k">private</span> <span class="k">void</span> <span class="nf">SomeInteraction</span><span class="p">(</span><span class="n">ClickEvent</span> <span class="n">evt</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="c1">// Interact with the elements here.</span>
     <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div></div></ol><h3 id="element-first-approach"> <a class="anchor" href="#element-first-approach" aria-hidden="true" spy-title="Element-first approach"><span class="octicon octicon-link"></span></a>Element-first approach</h3><p>Cách tiếp cận Element-first sẽ thêm children trong quá trình xây dựng element.<p>Với tiếp cận này, bạn chỉ bao gồm các phần tử con trong tài liệu UXML phân cấp và sử dụng C# để tải tài liệu UXML phân cấp vào định nghĩa lớp CardElement. Cách tiếp cận này cung cấp cấu trúc giao diện người dùng linh hoạt cho các điều khiển tùy chỉnh. Ví dụ: bạn có thể tải các tài liệu UXML phân cấp khác nhau tùy thuộc vào các điều kiện cụ thể.<ol><li>UXML document (CardElement.uxml)<li><p>Tạo “custom control class” (CardElement.cs): Lớp điều khiển tùy chỉnh gán giá trị hình ảnh và huy hiệu cho CardElement ở luôn contructor.<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
 <span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

 <span class="c1">// Define the custom control type.</span>
 <span class="k">public</span> <span class="k">class</span> <span class="nc">CardElement</span> <span class="p">:</span> <span class="n">VisualElement</span>
 <span class="p">{</span>
     <span class="c1">// Expose the custom control to UXML and UI Builder.</span>
     <span class="k">public</span> <span class="k">new</span> <span class="k">class</span> <span class="nc">UxmlFactory</span> <span class="p">:</span> <span class="n">UxmlFactory</span><span class="p">&lt;</span><span class="n">CardElementA</span><span class="p">&gt;</span> <span class="p">{}</span>

     <span class="k">private</span> <span class="n">VisualElement</span> <span class="n">portraitImage</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="s">"image"</span><span class="p">);</span>
     <span class="k">private</span> <span class="n">Label</span> <span class="n">attackBadge</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">Label</span><span class="p">&gt;(</span><span class="s">"attack-badge"</span><span class="p">);</span>
     <span class="k">private</span> <span class="n">Label</span> <span class="n">healthBadge</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">Label</span><span class="p">&gt;(</span><span class="s">"health-badge"</span><span class="p">);</span>


     <span class="c1">// Custom controls need a default constructor. This default constructor calls the other constructor in this class.</span>
     <span class="k">public</span> <span class="nf">CardElement</span><span class="p">()</span> <span class="p">{}</span>

     <span class="c1">// Define a constructor that loads the UXML document that defines CardElement and assigns an image and badge values.</span>
     <span class="k">public</span> <span class="nf">CardElement</span><span class="p">(</span><span class="n">Texture2D</span> <span class="n">image</span><span class="p">,</span> <span class="kt">int</span> <span class="n">health</span><span class="p">,</span> <span class="kt">int</span> <span class="n">attack</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="c1">// It assumes the UXML file is called "CardElement.uxml" and is placed at the "Resources" folder.</span>
         <span class="kt">var</span> <span class="n">asset</span> <span class="p">=</span> <span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">&lt;</span><span class="n">VisualTreeAsset</span><span class="p">&gt;(</span><span class="s">"CardElement"</span><span class="p">);</span> <span class="c1">// (CardElement.uxml)</span>
         <span class="n">asset</span><span class="p">.</span><span class="nf">CloneTree</span><span class="p">(</span><span class="k">this</span><span class="p">);</span> <span class="c1">// Build a tree of VisualElements from the asset. Return the root of the tree of VisualElements that was just cloned.</span>

         <span class="n">portraitImage</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">backgroundImage</span> <span class="p">=</span> <span class="n">image</span><span class="p">;</span>
         <span class="n">attackBadge</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">health</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
         <span class="n">healthBadge</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="n">attack</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
     <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div></div><li><p>Khởi tạo bên trong UXML gốc<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;CardElement</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;CardElement</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;CardElement</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><li><p>Khởi tạo trực tiếp trong C#<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
 <span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

 <span class="k">public</span> <span class="k">class</span> <span class="nc">UIManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
 <span class="p">{</span>
     <span class="k">public</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="n">UIDocument</span> <span class="n">document</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">UIDocument</span><span class="p">&gt;();</span>

         <span class="c1">// Create a loop to modify properties and perform interactions </span>
         <span class="c1">// for each card. It assumes that you have created a function </span>
         <span class="c1">// called `GetCards()` to get all the cards in your game.</span>
         <span class="k">foreach</span><span class="p">(</span><span class="n">Card</span> <span class="n">card</span> <span class="k">in</span> <span class="nf">GetCards</span><span class="p">())</span>
         <span class="p">{</span>
             <span class="kt">var</span> <span class="n">cardElement</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CardElement</span><span class="p">(</span><span class="n">card</span><span class="p">.</span><span class="n">image</span><span class="p">,</span> <span class="n">card</span><span class="p">.</span><span class="n">health</span><span class="p">,</span> <span class="n">card</span><span class="p">.</span><span class="n">attack</span><span class="p">);</span>

             <span class="c1">// Register an event callback for additional interaction.</span>
             <span class="n">cardElement</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">ClickEvent</span><span class="p">&gt;(</span><span class="n">SomeInteraction</span><span class="p">);</span>

             <span class="c1">// Add the custom element into the scene.</span>
             <span class="n">document</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">cardElement</span><span class="p">);</span>
         <span class="p">}</span>
     <span class="p">}</span>

     <span class="k">private</span> <span class="k">void</span> <span class="nf">SomeInteraction</span><span class="p">(</span><span class="n">ClickEvent</span> <span class="n">evt</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="c1">// Interact with the elements here.</span>
     <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div></div></ol><h2 id="set-up-the-scene"> <a class="anchor" href="#set-up-the-scene" aria-hidden="true" spy-title="Set up the scene"><span class="octicon octicon-link"></span></a>Set up the scene</h2><p>GameObject “UIDocument” cần có 2 reference là “source asset” và “script” extend “MonoBehaviour” để add component cho “UIDocument”.<ol><li>Tạo UI Document (.uxml) làm UI của game.<li>Tạo Script extend “MonoBehaviour” để sử dụng add component<li>Tạo một GameObject “UIDocument” trong Scene và thêm UI Document ở bước (1) làm “source asset” và add component là Script ở bước (2).</ol><p><strong>UI Document (.uxml)</strong><br><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span>
        <span class="na">xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">engine=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">editor=</span><span class="s">"UnityEditor.UIElements"</span>
        <span class="na">noNamespaceSchemaLocation=</span><span class="s">"../UIElementsSchema/UIElements.xsd"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">style=</span><span class="s">"flex-grow: 1;"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ui:Label</span> <span class="na">text=</span><span class="s">"This is a Label"</span> <span class="na">display-tooltip-when-elided=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ui:Button</span> <span class="na">text=</span><span class="s">"This is a Button"</span> <span class="na">display-tooltip-when-elided=</span><span class="s">"true"</span> <span class="na">name=</span><span class="s">"button"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ui:Toggle</span> <span class="na">label=</span><span class="s">"Display the counter?"</span> <span class="na">name=</span><span class="s">"toggle"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;ui:TextField</span> <span class="na">picking-mode=</span><span class="s">"Ignore"</span> <span class="na">label=</span><span class="s">"Text Field"</span> <span class="na">text=</span><span class="s">"filler text"</span> <span class="na">name=</span><span class="s">"input-message"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ui:VisualElement&gt;</span>
<span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><p><strong>Script extend “MonoBehaviour”</strong><br><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">SimpleRuntimeUI</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">Button</span> <span class="n">_button</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Toggle</span> <span class="n">_toggle</span><span class="p">;</span>

    <span class="k">private</span> <span class="kt">int</span> <span class="n">_clickCount</span><span class="p">;</span>

    <span class="c1">//Add logic that interacts with the UI controls in the `OnEnable` methods</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnEnable</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// The UXML is already instantiated by the UIDocument component</span>
        <span class="kt">var</span> <span class="n">uiDocument</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">UIDocument</span><span class="p">&gt;();</span>

        <span class="n">_button</span> <span class="p">=</span> <span class="n">uiDocument</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="s">"button"</span><span class="p">)</span> <span class="k">as</span> <span class="n">Button</span><span class="p">;</span>
        <span class="n">_toggle</span> <span class="p">=</span> <span class="n">uiDocument</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="s">"toggle"</span><span class="p">)</span> <span class="k">as</span> <span class="n">Toggle</span><span class="p">;</span>

        <span class="n">_button</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">ClickEvent</span><span class="p">&gt;(</span><span class="n">PrintClickMessage</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">_inputFields</span> <span class="p">=</span> <span class="n">uiDocument</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Q</span><span class="p">(</span><span class="s">"input-message"</span><span class="p">);</span>
        <span class="n">_inputFields</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">ChangeEvent</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;&gt;(</span><span class="n">InputMessage</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnDisable</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_button</span><span class="p">.</span><span class="n">UnregisterCallback</span><span class="p">&lt;</span><span class="n">ClickEvent</span><span class="p">&gt;(</span><span class="n">PrintClickMessage</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">PrintClickMessage</span><span class="p">(</span><span class="n">ClickEvent</span> <span class="n">evt</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="p">++</span><span class="n">_clickCount</span><span class="p">;</span>

        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="s">"button"</span><span class="p">}</span><span class="s"> was clicked!"</span> <span class="p">+</span>
                <span class="p">(</span><span class="n">_toggle</span><span class="p">.</span><span class="k">value</span> <span class="p">?</span> <span class="s">" Count: "</span> <span class="p">+</span> <span class="n">_clickCount</span> <span class="p">:</span> <span class="s">""</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">InputMessage</span><span class="p">(</span><span class="n">ChangeEvent</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">evt</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">evt</span><span class="p">.</span><span class="n">newValue</span><span class="p">}</span><span class="s"> -&gt; </span><span class="p">{</span><span class="n">evt</span><span class="p">.</span><span class="n">target</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="example-mainui-sử-dụng-thêm-uxml-cho-các-phần-khác-của-ui"> <a class="anchor" href="#example-mainui-s%E1%BB%AD-d%E1%BB%A5ng-th%C3%AAm-uxml-cho-c%C3%A1c-ph%E1%BA%A7n-kh%C3%A1c-c%E1%BB%A7a-ui" aria-hidden="true" spy-title="Example: MainUI sử dụng thêm UXML cho các phần khác của UI"><span class="octicon octicon-link"></span></a>Example: MainUI sử dụng thêm UXML cho các phần khác của UI</h2><ol><li>Tạo MainUI.uxml + MainUI.uss<li>Tạo Custom Control: WithAnImageAsset.uxml + WithAnImageAsset.cs : VisualElement<li>Tạo MainUI.cs : MonoBehaviour để add Component cho UIDocument. MainUI.cs thực hiện add Custom Control vào rootVisualElement<li>Tạo UIDocument và kéo UXML vào Source Asset và add Component là MainUI.cs</ol><p><strong>MainUI.uxml</strong><br><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">engine=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">editor=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">noNamespaceSchemaLocation=</span><span class="s">"../UIElementsSchema/UIElements.xsd"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Style</span> <span class="na">src=</span><span class="s">"project://database/Assets/UI/PositioningTest.uss?fileID=7433441132597879392&amp;amp;guid=b58854dc6d9143c43b21527e4edfaf5c&amp;amp;type=3#PositioningTest"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">class=</span><span class="s">"box"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">class=</span><span class="s">"box"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:Label</span> <span class="na">text=</span><span class="s">"Relative\nPos\n25, 0"</span> <span class="na">name=</span><span class="s">"relative"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">class=</span><span class="s">"box"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">class=</span><span class="s">"box"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;ui:Label</span> <span class="na">text=</span><span class="s">"Absolute\nPos\n25, 25"</span> <span class="na">name=</span><span class="s">"absolutePositionElement"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><p><strong>MainUI.uss</strong><br><div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.box</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">2px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">gray</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#relative</span><span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span> 
    <span class="nl">height</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span> 
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">purple</span><span class="p">;</span> 
    <span class="nl">left</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span> 
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">2px</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span><span class="nb">relative</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#absolutePositionElement</span><span class="p">{</span>
    <span class="nl">left</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span> 
    <span class="nl">top</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span> 
    <span class="nl">width</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span> 
    <span class="nl">height</span><span class="p">:</span> <span class="m">70px</span><span class="p">;</span> 
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p><strong>WithAnImageAsset.uxml</strong><br><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ui:UXML</span> <span class="na">xmlns:ui=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">xmlns:uie=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">engine=</span><span class="s">"UnityEngine.UIElements"</span> <span class="na">editor=</span><span class="s">"UnityEditor.UIElements"</span> <span class="na">noNamespaceSchemaLocation=</span><span class="s">"../../../../UIElementsSchema/UIElements.xsd"</span> <span class="na">editor-extension-mode=</span><span class="s">"False"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ui:VisualElement</span> <span class="na">style=</span><span class="s">"position: absolute; top: 0; right: 0;"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ui:VisualElement</span> <span class="na">name=</span><span class="s">"VElm01"</span> <span class="na">style=</span><span class="s">"height: 200px; background-image: url(&amp;apos;project://database/Assets/Backgrounds/4.bmp?fileID=2800000&amp;amp;guid=9a8a37633dcc73540b906cf4ed2b83b1&amp;amp;type=3#4&amp;apos;); -unity-background-scale-mode: scale-and-crop; width: 350px;"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;ui:VisualElement</span> <span class="na">name=</span><span class="s">"VElm02"</span> <span class="na">style=</span><span class="s">"height: 200px;"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/ui:VisualElement&gt;</span>
<span class="nt">&lt;/ui:UXML&gt;</span>
</code></pre></div></div><p><strong>WithAnImageAsset.cs</strong><br><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEditor</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">WithAnImageAsset</span> <span class="p">:</span> <span class="n">VisualElement</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">WithAnImageAsset</span><span class="p">()</span> <span class="c1">// default ctor</span>
    <span class="p">{</span>
        <span class="c1">//Init(); // chuyển qua sử dụng AttachToPanelEvent / DetachFromPanelEvent</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">new</span> <span class="k">class</span> <span class="nc">UxmlFactory</span> <span class="p">:</span> <span class="n">UxmlFactory</span><span class="p">&lt;</span><span class="n">WithAnImageAsset</span><span class="p">&gt;</span> <span class="p">{}</span> <span class="c1">// expose</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Init</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// AssetDatabase thuộc namespace UnityEditor</span>
        <span class="kt">var</span> <span class="n">uxmlTemplate</span> <span class="p">=</span> <span class="n">AssetDatabase</span><span class="p">.</span><span class="n">LoadAssetAtPath</span><span class="p">&lt;</span><span class="n">VisualTreeAsset</span><span class="p">&gt;(</span><span class="s">"Assets/UI/SetBackgroundImages/WithAnImageAsset/WithAnImageAsset.uxml"</span><span class="p">);</span>
        <span class="n">uxmlTemplate</span><span class="p">.</span><span class="nf">CloneTree</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nf">SetBG</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">void</span> <span class="nf">SetBG</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">VElm02</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">Q</span><span class="p">&lt;</span><span class="n">VisualElement</span><span class="p">&gt;(</span><span class="s">"VElm02"</span><span class="p">);</span>
        <span class="c1">//VElm02.style.width = 350; // trong UXML đã khai báo</span>
        <span class="c1">//VElm02.style.height = 200;</span>

        <span class="c1">// AssetDatabase.LoadAssetAtPath cần full path kể cả 'Assets/.../*.jpg'</span>
        <span class="c1">//var bg = AssetDatabase.LoadAssetAtPath&lt;Texture2D&gt;("Assets/Backgrounds/3.jpg");</span>

        <span class="c1">// Resources.Load tính từ Assets/Resources, ko bao gồm Resources và phần mở rộng của file</span>
        <span class="kt">var</span> <span class="n">bg</span> <span class="p">=</span> <span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">&lt;</span><span class="n">Texture2D</span><span class="p">&gt;(</span><span class="s">"Backgrounds/1"</span><span class="p">);</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">bg</span><span class="p">);</span>

        <span class="n">VElm02</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">backgroundImage</span> <span class="p">=</span> <span class="n">bg</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p><strong>MainUI.cs</strong><br><div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.UIElements</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">MainUI</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">//[SerializeField] private VisualTreeAsset secondVElm;</span>
    <span class="c1">//[SerializeField] private VisualTreeAsset thirdVElm;</span>
    <span class="k">void</span> <span class="nf">OnEnable</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">uiDoc</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">UIDocument</span><span class="p">&gt;();</span>
        <span class="kt">var</span> <span class="n">withAnImageAsset</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WithAnImageAsset</span><span class="p">();</span>
        <span class="c1">// WithAnImageAsset không khởi tạo ở Contructor nên đăng ký event này để call Init()</span>
        <span class="n">withAnImageAsset</span><span class="p">.</span><span class="n">RegisterCallback</span><span class="p">&lt;</span><span class="n">AttachToPanelEvent</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
            <span class="n">withAnImageAsset</span><span class="p">.</span><span class="nf">Init</span><span class="p">();</span>
            <span class="n">withAnImageAsset</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Position</span><span class="p">.</span><span class="n">Absolute</span><span class="p">;</span>
            <span class="n">withAnImageAsset</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">top</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="n">withAnImageAsset</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">right</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="n">uiDoc</span><span class="p">.</span><span class="n">rootVisualElement</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">withAnImageAsset</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h2 id="image-import-settings"> <a class="anchor" href="#image-import-settings" aria-hidden="true" spy-title="Image import settings"><span class="octicon octicon-link"></span></a>Image import settings</h2><p>Sau khi bạn đã nhập hình ảnh vào dự án của mình, để có kết quả trực quan nhất, bạn nên áp dụng một số cài đặt nhập nhất định cho Textures, Sprites, and Vector trước khi bạn sử dụng chúng làm nền cho thành phần trực quan trong giao diện người dùng Người xây dựng.<p><a href="https://docs.unity3d.com/2021.3/Documentation/Manual/UIE-image-import-settings.html" class="hvr-forward" rel="nofollow" target="_blank">Các settings ở đây</a><h2 id="uss-transition-và-transition-events"> <a class="anchor" href="#uss-transition-v%C3%A0-transition-events" aria-hidden="true" spy-title="USS transition và Transition events"><span class="octicon octicon-link"></span></a>USS transition và Transition events</h2><p>USS transition thay đổi giá trị thuộc tính trong một khoảng thời gian nhất định (tương tự như CSS transition), sử dụng để thực hiện các animation cho UI.<p><a href="https://docs.unity3d.com/2021.3/Documentation/Manual/UIE-Transitions.html" class="hvr-forward" rel="nofollow" target="_blank">Xem thêm USS transition ở đây</a><p>Transition events thông báo cho bạn về những thay đổi trong trạng thái của quá trình chuyển đổi.<p><a href="https://docs.unity3d.com/2021.3/Documentation/Manual/UIE-Transition-Events.html" class="hvr-forward" rel="nofollow" target="_blank">Xem thêm Transition events ở đây</a><h2 id="tips"> <a class="anchor" href="#tips" aria-hidden="true" spy-title="Tips:"><span class="octicon octicon-link"></span></a>Tips:</h2><ul><li>Load UXML sẽ được object kiểu “VisualTreeAsset” =&gt; cần .Instantiate() để được “VisualElement”<li>“rootVisualElement” là một “VisualElement”, giống “gameObject” luôn có sẵn và reference đển TOP-Element (giống “document” của HTML)<li>“Custom Control” gồm UXML + Script C# extend “VisualElement” (CloneTree(this)), Script C# cần “EXPOSE to UXML and UI Builder” và cần có “DEFAULT constructor”. Script C# đại diện UXML để sử dụng trong coding (gán giá trị cần thiết ở Contructor hoặc Init khi thích hợp).<li>UXML đại diện luôn là “VisualTreeAsset” kể cả có reference bằng kéo thả ([SerializeField])<li>sử dụng uxmlModal.CloneTree(this) thì không cần Instantiate() đã có luôn VisualElement cho “this”<li>các UIDocument chung panelSettings có “rootVisualElement” riêng, “rootVisualElement” từ UIDocument không phải là “panelSettings”</ul></div></div></article><div class="w3-padding-16"></div><div class="opacity-transition-hover"><h5>Xem thêm các bài viết khác cùng chủ đề</h5><ul class="w3-ul"> <a href="/collections/game-development/google-play-tich-hop-tinh-nang-phan-phoi-assets-unity" class="hvr-forward"><li><span></span>[Google Play] Play Asset Delivery (PAD) cho Unity · 1 min read </a> <a href="/collections/game-development/unity-bien-dich-co-dieu-kien-conditional-compilation" class="hvr-forward"><li><span></span>Biên dịch có điều kiện (Conditional compilation) · 1 min read </a> <a href="/collections/game-development/unity-cach-de-lam-game-tro-nen-thu-vi" class="hvr-forward"><li><span></span>Cách để làm một Game trở nên thú vị · 3 mins read </a> <a href="/collections/game-development/unity-cau-truc-project-va-thu-tu-compile" class="hvr-forward"><li><span></span>Cấu trúc và thứ tự Compile của một project Unity · 5 mins read </a> <a href="/collections/game-development/unity-di-chuyen-mot-gameobject" class="hvr-forward"><li><span></span>Unity - Di chuyển một GameObject · 8 mins read </a> <a href="/collections/game-development/unity-graphic-textures-sprites-render-textures" class="hvr-forward"><li><span></span>Graphics: Textures, Sprites, Render textures · 1 min read </a> <a href="/collections/game-development/unity-hien-thi-inspector-dua-vao-bien-public-cua-script" class="hvr-forward"><li><span></span>Hiển thị Inspector dựa vào biến Public của Script · 1 min read </a> <a href="/collections/game-development/unity-input-manager-input-system-mobile-device-input" class="hvr-forward"><li><span></span>Unity Input Manager - Input System - Mobile device input · 11 mins read </a> <a href="/collections/game-development/unity-physics-mo-phong-vat-ly-va-cham" class="hvr-forward"><li><span></span>Physics: mô phỏng vật lý, gia tốc, trọng lực, va chạm · 14 mins read </a> <a href="/collections/game-development/unity-system-attribute-cua-unity" class="hvr-forward"><li><span></span>System.Attribute của UnityEngine · 3 mins read </a> <a href="/collections/game-development/unity-toan-hoc-co-ban-khong-gian-3d-trong-unity" class="hvr-forward"><li><span></span>Toán học cơ bản liên quan đến không gian 3 chiều trong Unity Engine · 4 mins read </a> <a href="/collections/game-development/unity-trinh-tu-goi-event-function-lifecycle-script" class="hvr-forward"><li><span></span>Trình tự gọi các Event Functions (Script lifecycle) · 5 mins read </a><li><span></span>→ [User interface (UI)] giao diện người dùng (UI) cho Unity · 32 mins read <a href="/collections/game-development/unity-van-de-ve-kich-thuoc-trong-game" class="hvr-forward"><li><span></span>Vấn đề kích thước trong game · 2 mins read </a></ul></div><script src="/assets/js/search-custom.min.js" type="text/javascript"></script> <script> (function() { JSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('results-container'), json: '/search/search-collections.json' }) })(); </script><div id="qModal" class="w3-modal"><div class="w3-modal-content"><div class="w3-container"> <span onclick="document.getElementById('qModal').style.display='none'" class="w3-button w3-display-topright">&times;</span><div><p id="qModalSentenceEmpty" class="w3-panel"><hr><p id="qModalSentencePice" class="w3-panel"><p id="qModalAnswerMsg" class="w3-panel" style="display: none;"><span class="w3-red">Không đúng rôi! thử lại đi...</span><hr><p class="w3-panel"> <button class="material-icons w3-btn w3-border" id="qModalAudioControlEl" onclick="qModalAudioControlPlay()" title="Play the sound">play_arrow</button> <button class="material-icons w3-btn w3-border" id="qModalResetQuizEl" onclick="qModalResetQuiz()" title="Reset the quiz">cached</button> <button class="material-icons w3-btn w3-border" id="qModalGiveUpAndShowAnswerEl" onclick="qModalGiveUpAndShowAnswer()" title="Give up...">close</button> <button class="w3-btn w3-white w3-border" onclick="clearFormTextArea()" title="Clear the textarea">Clear</button><p id="qModalSentenceTypeArea" class="w3-panel"> <textarea id="sentenceTypeAreaId" style="margin: 0px;width: 100%;height: 99px;" onkeyup="qModalTxtAreaOnkeyup()"></textarea></div><div id="qModalTotoList" class="w3-container"><ul id="myUL"><li onclick="onClickTodoList(this)">1. Làm quiz hoàn thành câu<li onclick="onClickTodoList(this)">2. Nghe Audio và nhại theo 3 lần<li onclick="onClickTodoList(this)">3. Tự nói lại mà không nghe Audio và nhìn vào chữ đúng 3 lần<li onclick="onClickTodoList(this)">4. Gõ lại câu đến khi chính xác<li onclick="onClickTodoList(this)">5. Phân tích cú pháp và lấy ví dụ tương tự (thay các từ loại, chủ ngữ, nếu là câu hỏi thì trả lời câu hỏi)</ul></div><div class="w3-panel"></div></div></div></div><style> #qModalTotoList ul { list-style: none; margin: 0; padding: 0; } /* Style the list items */ #qModalTotoList ul li { cursor: pointer; position: relative; padding: 12px 8px 12px 40px; background: #eee; font-size: 18px; transition: 0.2s; /* make the list items unselectable */ -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } /* Set all odd list items to a different color (zebra-stripes) */ #qModalTotoList ul li:nth-child(odd) { background: #f9f9f9; } /* Darker background-color on hover */ #qModalTotoList ul li:hover { background: #ddd; } /* When clicked on, add a background color and strike out text */ #qModalTotoList ul li.checked { background: #888; color: #fff; text-decoration: line-through; } /* Add a "checked" mark when clicked on */ #qModalTotoList ul li.checked::before { content: ''; position: absolute; border-color: #fff; border-style: solid; border-width: 0 2px 2px 0; top: 10px; left: 16px; transform: rotate(45deg); height: 15px; width: 7px; } /* Style the close button */ #qModalTotoList .close { position: absolute; right: 0; top: 0; padding: 12px 16px 12px 16px; } #qModalTotoList .close:hover { background-color: #f44336; color: white; }</style><script> /* toggle 'checked' class on Todo list */ function onClickTodoList(thisVar) { thisVar.classList.toggle('checked'); } /* Create a "close" button and append it to each list item */ function appendCloseButton() { var myNodelist = document.getElementsByTagName("LI"); var i; for (i = 0; i < myNodelist.length; i++) { var span = document.createElement("SPAN"); var txt = document.createTextNode("\u00D7"); span.className = "close"; span.appendChild(txt); myNodelist[i].appendChild(span); } } /* Click on a close button to hide the current list item */ function addOnclickToCloseButton() { var close = document.getElementsByClassName("close"); var i; for (i = 0; i < close.length; i++) { close[i].onclick = function () { var div = this.parentElement; div.style.display = "none"; } } } /* Add a "checked" symbol when clicking on a list item */ function addEventClickOnList() { var list = document.querySelector('ul'); list.addEventListener('click', function (ev) { if (ev.target.tagName === 'LI') { ev.target.classList.toggle('checked'); } }, false); } /* Create a new list item when clicking on the "Add" button */ function newElement() { var li = document.createElement("li"); var inputValue = document.getElementById("myInput").value; var t = document.createTextNode(inputValue); li.appendChild(t); if (inputValue === '') { alert("You must write something!"); } else { document.getElementById("myUL").appendChild(li); } document.getElementById("myInput").value = ""; var span = document.createElement("SPAN"); var txt = document.createTextNode("\u00D7"); span.className = "close"; span.appendChild(txt); li.appendChild(span); for (i = 0; i < close.length; i++) { close[i].onclick = function () { var div = this.parentElement; div.style.display = "none"; } } } </script></main><div id="tocMenu" class="tocMenu" onclick="toggleTOC()"><div class="progress-bar" id="progressBar"></div><div title="Table Of Content" class="w3-btn w3-border w3-border-blue w3-white"> Outline</div></div><div id="audioControlGroup" class="w3-animate-opacity"><p> <span class="material-icons w3-button w3-border w3-border-blue" onclick="audioControlMinus()" title="Minus">history</span> <span class="material-icons w3-button w3-border w3-border-blue" onclick="resetCurrentAudio()" title="Reset">cached</span><p> <span class="material-icons w3-button w3-border w3-border-blue" id="audioControlEl" onclick="audioControlPlayOrPause()" title="Play/Pause">play_arrow</span> <span class="material-icons w3-button w3-border w3-border-blue" onclick="onClickGotoCurrentAudio()" title="Go to Current Audio">arrow_right_alt</span><p> <span class="material-icons w3-button w3-border w3-border-blue" onclick="audioControlPlus()" title="Plus">update</span> <span class="material-icons w3-button w3-border w3-border-blue" onclick="skipCurrentAudioAndNext()" title="Next">skip_next</span><p> <span class="material-icons w3-button w3-border w3-border-blue" onclick="openMemo()" title="Your Note">create</span> <span class="material-icons w3-button w3-border w3-border-blue" onclick="onClickShowAudioControl()" title="Hide Audio Control">close</span><p> <span class="material-icons w3-button w3-border w3-border-blue" onclick="openAudioSettings()" title="Audio Settings">settings</span> <span class="material-icons w3-button w3-border w3-border-blue" onclick="gotoBottom()" title="Go to bottom">arrow_downward</span></div><link rel="stylesheet" href="/assets/css/quill.1.3.6.snow.css" media="none" onload="if(media!='all')media='all'"> <noscript><link rel="stylesheet" href="/assets/css/quill.1.3.6.snow.css"></noscript><div id="quillNote" class="w3-modal"><div class="w3-modal-content w3-card-4 w3-animate-top" style="max-width:600px"><header class="w3-container light-grey"> <span onclick="document.getElementById('quillNote').style.display='none'" class="w3-button w3-hover-red w3-xlarge w3-display-topright">&times;</span><h2>Memo</h2></header><div class="w3-container w3-section"><div id="quillNoteEditor"></div></div><div class="w3-container w3-light-grey w3-padding"> <button class="w3-button w3-right w3-white w3-border" onclick="onNoteSave()">Save</button></div></div></div><script src="/assets/js/quill.1.3.6.js" type="text/javascript" async></script> <script type="text/javascript"> function openMemo() { try { document.getElementById('audioSettings').style.display='none'; } catch (error) { console.log(error); } toggleElmDisplay(document.getElementById('quillNote')); } function onNoteSave() { const pathKey = window.location.pathname; window.localStorage.setItem(pathKey, window.quillEditor.getHTML()); document.getElementById('quillNote').style.display = 'none'; } function loadMemo() { const pathKey = window.location.pathname; const memo = window.localStorage.getItem(pathKey); if (memo) { window.quillEditor.setHTML(memo); } } </script> <button onclick="topFunction()" title="Go to Top" id="scrollTopBtn" class="w3-btn w3-border w3-border-blue w3-white">Top</button><div id="zoomModal" class="w3-modal w3-center w3-animate-opacity" onclick="this.style.display='none'"> <img class="w3-modal-content w3-mobile w3-animate-zoom" style="width: 100%;" id="imgModal"></div><script type="text/javascript"> function openAudioControl() { } </script><footer class="w3-center w3-padding-16 dh-clear"></footer><div id="snackbar">...</div></div><script src="/assets/js/quote-api.js" type="text/javascript" async></script> <script src="/assets/js/custom.js" type="text/javascript" async></script> <script src="/assets/js/qmodal.js" type="text/javascript" async></script><link href="/assets/css/tango-highlight.css" rel="stylesheet" media="all">
